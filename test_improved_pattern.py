#!/usr/bin/env python3
"""
개선된 법령+조항 추출 패턴 테스트 스크립트
"""

import pytest
from law_article_extractor import extract_law_articles

test_cases = [
    # (입력, 기대 결과 리스트)
    (
        "연계정보 검색 1. 건축법 시행령 [시행 2025. 1. 21.] [대통령령 제35221호, 2025. 1. 21., 타법개정] 제12조 허가·신고사항의 변경 등 건축법 시행령 [시행 2025. 1. 21.] [대통령령 제35221호, 2025. 1. 21., 타법개정] 제12조(허가ㆍ신고사항의 변경 등) ① 법 제16조 제1항 에 따라",
        [("건축법 시행령", "12")],
    ),
    (
        '조문정보 국토의 계획 및 이용에 관한 법률 시행규칙 [시행 2024. 5. 29.] [국토교통부령 제1338호, 2024. 5. 29., 일부개정] 제3조(경미한 도시ㆍ군관리계획변경사항) ① 영 제25조제3항제1호다목에서 "국토교통부령으로 정하는 경미한 사항의 변경"이란 다음 각 호의 어느 하나에 해당하는 변경을 말한다. <신설 2019.8.7, 2023.1.27> 1. 「도시계획시설의 결정ㆍ구조 및 설치기준에 관한 규칙」 제14조의',
        [("국토의 계획 및 이용에 관한 법률 시행규칙", "3")],
    ),
    (
        "건축법 시행령[시행 2025. 1. 21.] [대통령령 제35221호, 2025. 1. 21., 타법개정] 제12조",
        [("건축법 시행령", "12")],
    ),
    ("건축법 제12조", [("건축법", "12")]),
    ("건축법[시행 2024.1.1] 제16조", [("건축법", "16")]),
    ("부칙[시행 2024.1.1] 제1조", [("부칙", "1")]),
    ("별표[개정 2024.1.1] 1", [("별표", "1")]),
    ("별지[시행 2024.1.1] 2", [("별지", "2")]),
    (
        "건축법 시행령[시행 2025.1.21][대통령령 제35221호] 제14조",
        [("건축법 시행령", "14")],
    ),
    ("건축법 시행규칙[시행 2024.1.1][부령 제123호] 제7조", [("건축법 시행규칙", "7")]),
]


@pytest.mark.parametrize("text, expected", test_cases)
def test_extract_law_articles(text, expected):
    articles = extract_law_articles(text)
    result = [(a["law_name"], a["article_num"]) for a in articles]
    assert result == expected
